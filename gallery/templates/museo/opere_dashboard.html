{% extends "museo/base.html" %}
{% load static %}

{% block title %}Museo – Strumenti Staff{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- Intro -->
  <div class="card shadow-sm mb-4 rounded-4">
    <div class="card-body p-4">
      <div class="d-flex align-items-center gap-3 flex-wrap">
        <img src="{% static 'icon/logo.png' %}" alt="MV" style="width:64px;height:64px;object-fit:contain">
        <div>
          <h1 class="h4 mb-1">Pannello operativo Museo</h1>
          <p class="text-muted mb-0">
            Strumenti interni per la gestione di opere, autori, sale, temi e comunicazioni.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- VETRINA (colorata, immagini via JS come in Temi) -->
  <section class="mb-4">
    <h2 class="h5 mb-3">Vetrina</h2>
    <div class="row g-3">
      <div class="col-6 col-md-3">
        <div class="card gallery-card shadow-sm rounded-4">
          <div class="ratio ratio-4x3 bg-cover rounded-top-4" data-img="gallery_1.jpg"></div>
          <div class="card-body p-2">
            <div class="small text-muted">Opera</div>
            <div class="fw-semibold text-truncate text-dark">Sfumature</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card gallery-card shadow-sm rounded-4">
          <div class="ratio ratio-4x3 bg-cover rounded-top-4" data-img="gallery_2.jpg"></div>
          <div class="card-body p-2">
            <div class="small text-muted">Opera</div>
            <div class="fw-semibold text-truncate text-dark">Ibrido</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card gallery-card shadow-sm rounded-4">
          <div class="ratio ratio-4x3 bg-cover rounded-top-4" data-img="gallery_3.jpg"></div>
          <div class="card-body p-2">
            <div class="small text-muted">Opera</div>
            <div class="fw-semibold text-truncate text-dark">Boschetto</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card gallery-card shadow-sm rounded-4">
          <div class="ratio ratio-4x3 bg-cover rounded-top-4" data-img="gallery_4.jpg"></div>
          <div class="card-body p-2">
            <div class="small text-muted">Opera</div>
            <div class="fw-semibold text-truncate text-dark">Ultimo canto</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Novità e informazioni (popup identico a Temi/Sale) -->
  <section class="mb-4">
    <h2 class="h5 mb-3">Novità e informazioni</h2>

    <div class="row g-3 align-items-stretch">
      <!-- Novità -->
      <div class="col-12 col-lg-6 d-flex">
        <div class="card shadow-sm rounded-4 h-100 w-100">
          <div class="card-body d-flex flex-column">
            <h3 class="h6">Novità operative</h3>
            <ul class="small text-muted mb-0">
              <li>Opere: filtri migliorati e messaggistica più chiara.</li>
              <li>Autori: validazione date (morte ≥ nascita) e messaggi a tempo.</li>
              <li>Temi: impaginazione 3+2 e descrizioni su hover riviste.</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Informazioni → apre modal -->
      <div class="col-12 col-lg-6 d-flex">
        <div id="card-informazioni" class="card shadow-sm rounded-4 h-100 w-100" role="button" tabindex="0">
          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-start mb-2">
              <h3 class="h6 mb-0">Informazioni</h3>
              <small class="text-muted">Aggiornate</small>
            </div>
            <p class="small text-muted mb-3">
              Linee guida interne su sale, “non esposto”, link da griglia Opere e messaggistica.
            </p>
            <div class="mt-auto">
              <span class="btn btn-outline-secondary btn-sm">Leggi articolo completo</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- MODALE (stessi id/nome di Temi) -->
  <div class="modal fade" id="temaModal" tabindex="-1" aria-labelledby="temaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-dark" id="temaModalLabel">Dettaglio tema</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Chiudi"></button>
        </div>
        <div class="modal-body">
          <h4 id="popup-titolo" class="text-dark"></h4>
          <div id="popup-testo" class="mt-3 text-dark"></div>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block extra_js %}
<style>
  /* Backdrop come in Temi (trasparente) */
  .modal-backdrop.show { background-color: transparent !important; pointer-events: none !important; }
  .modal { z-index: 9999 !important; pointer-events: auto !important; }
  .modal-content, .modal-header, .modal-body { pointer-events: auto !important; }

  /* Testo popup scuro e pieno */
  #temaModal .modal-content,
  #temaModal .modal-body,
  #temaModal .modal-body * { color:#212529 !important; opacity:1 !important; }

  /* Vetrina */
  .bg-cover{ background-size:cover; background-position:center; }
  .gallery-card:hover{ transform: translateY(-2px); box-shadow:0 8px 22px rgba(0,0,0,.08); transition:.2s ease; }
</style>

<!-- Include come in Temi (se già nel base, puoi toglierli) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  $(function () {
    /* Immagini vetrina via JS (pattern Temi) */
    const STATIC_IMG_BASE_HOME = "{% static 'img_ottimizzate' %}";
    $('[data-img]').each(function(){
      const f = $(this).data('img');
      if (f) $(this).css('background-image', "url('" + STATIC_IMG_BASE_HOME + "/" + f + "')");
    });

    /* Card Informazioni → apre il modal identico a Temi */
    $('#card-informazioni').on('click', function () {
      const titolo = 'Comunicazione interna – Linee guida esposizioni';
      const corpo = `
        <p>Dal 1° settembre le richieste di esposizione temporanea devono essere caricate nella sezione <strong>Sale</strong> indicando tema, superficie e periodo. I dati mancanti bloccano l’approvazione.</p>
        <p>Per le opere non esposte, usare la dicitura <em>non esposto</em> (evitare <em>NULL</em>). In caso di collegamenti autore/sala, assicurarsi che i link siano attivi dalla griglia Opere.</p>
        <ul>
          <li>Messaggi di errore: visibili, non persistenti, senza alert browser.</li>
          <li>Tipo opera: usare i radio button (quadro/scultura).</li>
          <li>Paginazione: non solo sequenziale; indicare pagina corrente.</li>
        </ul>
        <p class="mb-0">Riferimento: Linee Guida Progetto #1 e #2.</p>
      `;
      $('#popup-titolo').text(titolo);
      $('#popup-testo').html(corpo);
      new bootstrap.Modal(document.getElementById('temaModal')).show();
    });
  });
</script>
{% endblock %}










